# RetClean

# Abstract
Objectives: To assess the efficacy and potential risks of automated label cleaning in multimodal retinal image datasets and its effect on the performance of multi-categories classification.
Methods: Two datasets were constructed comprising 8 disease categories of color fundus photographs and 7 disease categories of optical coherence tomography scans. Label noise was intentionally introduced randomly and proportionally to establish multiple noisy gradients ranging from 0% to 70%. The Cleanlab open-source framework was employed to automatically detect and rectify label errors across multiple iterative cycles without manual confirmation. Furthermore, two label cleaning strategies were compared: one involved six consecutive rounds of cleaning, while the other utilize dataset quality scores (DQS) to guide the start and stop cleaning processes. Subsequently, a pre-training foundation model, RETFound, underwent fine-tuning processes using the datasets before and after cleaning separately, and their performances were compared. 
Results: Six-iteration data cleaning improved the label accuracies by 3.4% to 62.9% and DQS by 5.1% to 74.4%, except in the original noise-free datasets. Most (86.6% to 97.5%) label errors were correctly detected and modified. Only a few were missed (0.5% to 2.8%) or mistakenly modified to incorrect categories (0.4% to 10.6%). Furthermore, label cleaning alone significantly improved classification accuracies by 0.9% to 37.7%. However, over-cleaning reduced label accuracy and classification accuracy in the datasets with zero or low noise rate. DQS had an excellent correlation with label accuracy, and the data cleaning process guided by DQS did not have problem of reduced label and classification accuracies. External validation on two public datasets following DQS-guided strategy demonstrating that label accuracy increased from 0.906 to 0.924 for EyePACS and from 0.916 to 0.930 for APTOS-2013, with DQS improved from 0.9755 to 0.9965 and from 0.9547 to 0.9919, affirming effectiveness and applicability of our approach.
Conclusions: Simple implementation of Cleanlab in retinal image datasets is a highly automated and effective method for rectifying label errors, increasing dataset quality and enhancing the model performance of classification. DQS-guided cleaning strategy can prevent the risk of over-cleaning.  
Significance: Automated label cleaning not only enhances the reliability of medical imaging datasets but also increases the robustness of machine learning models. This improvement could potentially enhance the safety and efficacy of clinical applications of artificial intelligence in ophthalmology.
Keywords: color fundus photograph; optical coherence tomography; label noise; label cleaning; artificial intelligence.
